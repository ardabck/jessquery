<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Become Method Test</title>
  </head>
  <body>
    <div id="testContainer"></div>

    <div id="cycleMatchTest">
      <h2>Cycle Match Test:</h2>
      <div class="toBeReplaced">To Be Replaced 1</div>
      <div class="toBeReplaced">To Be Replaced 2</div>
      <div class="toBeReplaced">To Be Replaced 3</div>
      <div class="replacementElement">Replacement Element 1</div>
      <div class="replacementElement">Replacement Element 2</div>
    </div>

    <div id="ignoreMatchTest">
      <h2>Ignore Match Test:</h2>
      <div class="toBeReplaced">To Be Replaced 1</div>
      <div class="toBeReplaced">To Be Replaced 2</div>
      <div class="toBeReplaced">To Be Replaced 3</div>
      <div class="replacementElement">Replacement Element 1</div>
    </div>

    <script type="module">
      // Import your $ and $$ functions that return { raw: DOMElement }
      import { $, $$ } from "../index.js"

      // Define the become method
      function become(
        elements,
        replacements,
        options = { mode: "clone", match: "cycle" }
      ) {
        // Your become method implementation here
      }

      function runTests() {
        const output = document.createElement("div")
        document.getElementById("testContainer").appendChild(output)

        // Cycle Match Test
        const cycleMatchOutput = document.createElement("div")
        document.getElementById("cycleMatchTest").appendChild(cycleMatchOutput)

        const toBeReplacedElsCycle = $$("div.toBeReplaced")
        const replacementElsCycle = $$("div.replacementElement")

        toBeReplacedElsCycle.become(replacementElsCycle, {
          mode: "move",
          match: "cycle",
        })

        const replacedElementsCycle = document.querySelectorAll(
          ".replacementElement"
        )

        if (
          replacedElementsCycle.length === 3 &&
          !document.querySelectorAll(".toBeReplaced").length
        ) {
          cycleMatchOutput.style.color = "green"
          cycleMatchOutput.textContent = "Cycle Match Test PASSED"
        } else {
          cycleMatchOutput.style.color = "red"
          cycleMatchOutput.textContent = "Cycle Match Test FAILED"
        }

        // Ignore Match Test
        const ignoreMatchOutput = document.createElement("div")
        document
          .getElementById("ignoreMatchTest")
          .appendChild(ignoreMatchOutput)

        const toBeReplacedElsIgnore = $$("div.toBeReplaced")
        const replacementElsIgnore = $$("div.replacementElement")

        toBeReplacedElsIgnore.become(replacementElsIgnore, {
          mode: "move",
          match: "ignore",
        })

        const replacedElementsIgnore = document.querySelectorAll(
          ".replacementElement"
        )

        if (
          replacedElementsIgnore.length === 1 &&
          !document.querySelectorAll(".toBeReplaced").length
        ) {
          ignoreMatchOutput.style.color = "green"
          ignoreMatchOutput.textContent = "Ignore Match Test PASSED"
        } else {
          ignoreMatchOutput.style.color = "red"
          ignoreMatchOutput.textContent = "Ignore Match Test FAILED"
        }
      }

      // Add an event listener to ensure the DOM is fully loaded before running the tests.
      document.addEventListener("DOMContentLoaded", runTests)
    </script>
  </body>
</html>
